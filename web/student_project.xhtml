<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <f:view contentType="text/html" >
        <h:head>
            <f:facet name="first">
                <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
                <title>学生课程设计项目管理系统</title>
            </f:facet>
        </h:head>
        <h:body>
            <h:form id="form">
                <p:toolbar>
                    <f:facet name="left">
                        <p:button outcome="student_info"  value="我的信息" disabled="false"></p:button>
                        <p:button outcome="student_projectInfo"   value="项目信息" disabled="false"></p:button>   
                        <p:button outcome="solutions_student" value="解决方案" disabled="false"></p:button>
                    </f:facet>
                    <f:facet name="right">  
                        <p:menuButton value="学生：#{managedBean.studentId}" >
                            <p:menuitem value="登出"  action="#{managedBean.logout}"  icon="ui-icon-extlink"  />
                        </p:menuButton>
                    </f:facet>
                </p:toolbar> 

                <center>
                    <h1 style="text-align: center">我的信息</h1>
                    <p:growl id="growl" showDetail="true" />
                    <table border="2"  cellpadding="10" >
                        <tbody>
                            <tr>
                                <td><p:outputLabel value="学号"></p:outputLabel></td>
                                <td><p:outputLabel value="#{managedBean.studentId}"></p:outputLabel></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="姓名"></p:outputLabel></td>
                                <td><p:outputLabel value="#{managedBean.studentName}"></p:outputLabel></td>
                            </tr>
                            <tr>
                                <td>
                                    <p:outputLabel value="参与项目"></p:outputLabel>
                                </td>
                                <td>
                                    <p:commandLink value="#{managedBean.project.name}" oncomplete="PF('dialog4').show()" type="button"/>
                                </td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="课程名"></p:outputLabel></td>
                                <td><p:outputLabel value="#{managedBean.course.name}"></p:outputLabel></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="项目负责人"></p:outputLabel></td>
                                <td><p:outputLabel value="#{managedBean.project.headman}"></p:outputLabel></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="我的成绩"></p:outputLabel></td>
                                <td><p:outputLabel value="#{managedBean.student.totalMark}"></p:outputLabel></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="小组成员信息"></p:outputLabel></td>
                                <td>
                                    <p:commandButton value="查看" oncomplete="PF('ProjectStudentsDialog').show()"></p:commandButton>
                                </td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="个人报告"></p:outputLabel></td>
                                <td><p:commandButton  value="编辑"    action="#{editorView.showStudentReportEditDialog}">
                                        <p:ajax event="dialogReturn" listener="#{editorView.onReturn}" update="growl" />
                                    </p:commandButton></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="项目报告"></p:outputLabel></td>
                                <td><p:commandButton  value="编辑"    action="#{editorView.showProjectReportEditDialog}" update="growl">
                                        <p:ajax event="dialogReturn" listener="#{editorView.onReturn2}" update="growl" />
                                    </p:commandButton>
                                    <p:button value="上传项目报告文件"  outcome="upload_project"/>  
                                    <p:commandButton value="下载项目报告文件" ajax="false" onclick="PrimeFaces.monitorDownload();" icon="ui-icon-arrowthick-1-s">
                                        <p:fileDownload value="#{fileDownloadController.projectReport}" />
                                    </p:commandButton></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="学习进程"></p:outputLabel></td>
                                <td>
                                    <p:commandButton  value="前往" action="#{scheduleView.newStudentSchedule}" oncomplete="PF('scheduleDialog').show()" update=":level1form:dialog" >
                                        <f:setPropertyActionListener value="#{managedBean.student}" target="#{scheduleView.student}" /> 
                                    </p:commandButton></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="项目进程"></p:outputLabel></td>
                                <td>
                                    <p:commandButton  value="前往" action="#{scheduleView.newProjectSchedule}"  update=":level1form:dialog2" >
                                        <f:setPropertyActionListener value="#{managedBean.project}" target="#{scheduleView.project}" /> 
                                    </p:commandButton></td>
                            </tr>
                            <tr>
                                <td><p:outputLabel value="课程信息"></p:outputLabel></td>
                                <td>
                                    <h:dataTable  value="#{managedBean.course.getCourseScheduleCollection()}" var="cs"   class="big"> 
                                        <h:column>  
                                            <f:facet name="header">日期</f:facet>  
                                            <h:outputText value="#{cs.getCourseSchedulePK().getDate()}"/>  
                                        </h:column>
                                        <h:column>  
                                            <f:facet name="header">上午</f:facet>  
                                            <h:outputText value="#{cs.getAMContent()}"/>  
                                        </h:column>
                                        <h:column>  
                                            <f:facet name="header">下午</f:facet>  
                                            <h:outputText value="#{cs.getPMContent()}"/>  
                                        </h:column>
                                    </h:dataTable>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </center>
            </h:form>
            <h:form id="level1form">
                <p:dialog header="编辑项目名称" widgetVar="dialog4">
                    <p:inputText value="#{managedBean.project.name}"/>
                    <p:commandButton value="修改" actionListener="#{managedBean.changeProjectName()}"  ajax="false"/>
                </p:dialog>
                <p:dialog widgetVar="ProjectStudentsDialog" header="小组成员信息">
                    <p:dataTable value="#{newJSFManagedBean.group}" var="item" style="width: 600px" >
                        <f:facet name="header">
                            <p:outputLabel value="参与项目：#{newJSFManagedBean.user_project.name}____项目负责人：#{newJSFManagedBean.user_project.headman}"/>
                        </f:facet>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Id"/>
                            </f:facet>
                            <h:outputText value="#{item.getStudentPK().getId()}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="姓名"/>
                            </f:facet>
                            <h:outputText value="#{item.name}"/>
                        </p:column>
                        <!--
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="个人TotalMark"/>
                            </f:facet>
                            <h:outputText value="#{item.totalMark}"/>
                        </p:column>
                        -->
                    </p:dataTable>
                </p:dialog>
                <p:dialog id="dialog"  widgetVar="scheduleDialog" header="#{scheduleView.student.name}的个人进度表" modal="true">
                    <center>
                        <h:panelGrid columns="1">
                            <p:schedule id="schedule1"   value="#{scheduleView.eventModel}" widgetVar="myAMschedule" timeZone="GMT+8"
                                        leftHeaderTemplate="prev,next" rightHeaderTemplate="today"  style="width: 1000px"
                                        resizable="false" draggable="false"  view="basicWeek" aspectRatio="6"  initialDate="#{scheduleView.startDate}" >
                                <p:ajax event="dateSelect" listener="#{scheduleView.onAMDateSelect}" update="messages"/>
                                <p:ajax event="eventSelect" listener="#{scheduleView.onEventSelect}"  update="messages"/>
                            </p:schedule>
                            <p:messages id="messages" showDetail="true"  closable="true" showIcon="false"/>                  
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showLevel2btn1" actionListener="#{scheduleView.showAMDig()}" value="showDig"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onStudentReturn}" update="messages" oncomplete="PF('myAMschedule').update()"/>
                            </p:commandButton>
                            <!--下面的按钮隐藏了-->                     
                            <p:commandButton id="showEndDateBtn1" actionListener="#{scheduleView.showAMDialogEndDate()}" value="showDialogEndDate"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onStudentReturn}" update="messages" oncomplete="PF('myAMschedule').update()"/>
                            </p:commandButton>
                        </h:panelGrid>
                        <h:panelGrid columns="1">
                            <p:schedule id="schedule2"   value="#{scheduleView.pmEventModel}" widgetVar="myPMschedule" timeZone="GMT+8"
                                        leftHeaderTemplate="prev,next" rightHeaderTemplate="today"  style="width: 1000px"
                                        resizable="false" draggable="false"  view="basicWeek" aspectRatio="6"  initialDate="#{scheduleView.startDate}" >
                                <p:ajax event="dateSelect" listener="#{scheduleView.onPMDateSelect}" update="messages2"/>
                                <p:ajax event="eventSelect" listener="#{scheduleView.onEventSelect}"  update="messages2"/>
                            </p:schedule>
                            <p:messages id="messages2" showDetail="true"  closable="true" showIcon="false"/>                  
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showLevel2btn2" actionListener="#{scheduleView.showPMDig()}" value="showDig"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onStudentReturn}" update="messages2" oncomplete="PF('myPMschedule').update()"/>
                            </p:commandButton>
                            <!--下面的按钮隐藏了-->                     
                            <p:commandButton id="showEndDateBtn2" actionListener="#{scheduleView.showPMDialogEndDate()}" value="showDialogEndDate"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onStudentReturn}" update="messages2" oncomplete="PF('myPMschedule').update()"/>
                            </p:commandButton>
                        </h:panelGrid>
                    </center>       
                </p:dialog>
                <p:dialog id="dialog2"  widgetVar="scheduleDialog2" header="项目：#{scheduleView.project.name}的项目进度表" modal="true">
                    <center>
                        <h:panelGrid columns="1">
                            <p:schedule id="schedule3"   value="#{scheduleView.eventModel}" widgetVar="myAMschedule2" timeZone="GMT+8"
                                        leftHeaderTemplate="prev,next" rightHeaderTemplate="today"  style="width: 600px"
                                        resizable="false" draggable="false"  view="basicWeek" aspectRatio="6"  initialDate="#{scheduleView.startDate}" >
                                <p:ajax event="dateSelect" listener="#{scheduleView.onAMDateSelect2}" update="messages3"/>
                                <p:ajax event="eventSelect" listener="#{scheduleView.onEventSelect}"  update="messages3"/>
                            </p:schedule>
                            <p:messages id="messages3" showDetail="true"  closable="true" showIcon="false"/>    
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showLevel2btn3" actionListener="#{scheduleView.showAMDig2()}" value="hideDialog"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onProjectReturn}" update="messages3" oncomplete="PF('myAMschedule2').update()"/>
                            </p:commandButton>
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showEndDateBtn3" actionListener="#{scheduleView.showAMDialogEndDate2()}" value="showDialogEndDate"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onProjectReturn}" update="messages3" oncomplete="PF('myAMschedule2').update()"/>
                            </p:commandButton>
                        </h:panelGrid>
                        <h:panelGrid columns="1">
                            <p:schedule id="schedule4"   value="#{scheduleView.pmEventModel}" widgetVar="myPMschedule2" timeZone="GMT+8"
                                        leftHeaderTemplate="prev,next" rightHeaderTemplate="today"  style="width: 600px"
                                        resizable="false" draggable="false"  view="basicWeek" aspectRatio="6"  initialDate="#{scheduleView.startDate}" >
                                <p:ajax event="dateSelect" listener="#{scheduleView.onPMDateSelect2}" update="messages4"/>
                                <p:ajax event="eventSelect" listener="#{scheduleView.onEventSelect}"  update="messages4"/>
                            </p:schedule>
                            <p:messages id="messages4" showDetail="true"  closable="true" showIcon="false"/>                  
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showLevel2btn4" actionListener="#{scheduleView.showPMDig2()}" value="hideDialog"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onProjectReturn}" update="messages4" oncomplete="PF('myPMschedule2').update()"/>
                            </p:commandButton>
                            <!--下面的按钮隐藏了-->
                            <p:commandButton id="showEndDateBtn4" actionListener="#{scheduleView.showPMDialogEndDate2()}" value="showDialogEndDate"  style="display: none" >
                                <p:ajax event="dialogReturn" listener="#{scheduleView.onProjectReturn}" update="messages4" oncomplete="PF('myPMschedule2').update()"/>
                            </p:commandButton>
                        </h:panelGrid>
                    </center>
                </p:dialog>
            </h:form>
        </h:body>
    </f:view>
</html>

